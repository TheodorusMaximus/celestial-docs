---
import HeadSEO from "@/components/core/HeadSEO.astro";
import Header from "@/components/core/Header.astro";
import Footer from "@/components/core/Footer.astro";
import { Copy } from "@/components/core/Copy";

import SideNavMenu from "@/components/docs/SideNavMenu.astro";
import TableofContent from "@/components/docs/TableofContents.astro";
import MainContent from "@/components/docs/MainContent.astro";

import { ScrollArea } from "@/components/ui/scroll-area";

import type { DocsLayoutProps } from "@/lib/types";
import { menu, capitalizeFirstLetter } from "@/lib/utils";

import { LOCALE, SITE, docconfig } from "@/config";

const {
  title,
  author,
  pubDatetime,
  modDatetime,
  description,
  draft,
  tags,
  hide_breadcrumbs,
  hide_toc,
  hide_sidenav,
  max_width,
  headings,
} = Astro.props as DocsLayoutProps;
---

<!doctype html>
<html lang=`${LOCALE.lang ?? "en"}` class="scroll-smooth">
  <head>
    <HeadSEO
      title=`${title ? capitalizeFirstLetter(title) + " | " + SITE.title : SITE.title}`
      description={description}
    />
  </head>
  <body
    class=`font-sans ${hide_toc && hide_sidenav && max_width ? "" : "bg-card"}`
  >
    <Copy client:only="react" />
    <div class="flex flex-col min-h-screen">
      <Header class="border-b bg-background" />
      <main class="flex flex-1 flex-col md:flex-row container">
        <div
          class=`py-6 hidden md:flex max-h-static_sidemenu sticky top-[69px] 
          ${hide_toc && hide_sidenav && max_width ? "w-screen" : "md:px-4 md:w-1/3 lg:w-1/4"}`
        >
          <div class="w-full bg-card/50 border border-border/50 rounded-lg shadow-sm">
            <ScrollArea className="h-full w-full" client:only="react">
              {
                !docconfig.hide_side_navigations && !hide_sidenav && (
                  <div class="p-4">
                    {/* Enhanced Project Hub Header */}
                    <div class="mb-6 pb-4 border-b border-border/30">
                      <a 
                        href="/index" 
                        class="flex items-center gap-3 w-full bg-gradient-to-r from-blue-50 to-indigo-50 hover:from-blue-100 hover:to-indigo-100 dark:from-blue-950/30 dark:to-indigo-950/30 dark:hover:from-blue-900/50 dark:hover:to-indigo-900/50 text-blue-700 dark:text-blue-300 hover:text-blue-800 dark:hover:text-blue-200 font-bold py-4 px-5 rounded-xl border border-blue-200/60 dark:border-blue-700/60 hover:border-blue-300 dark:hover:border-blue-600 shadow-sm hover:shadow-lg transition-all duration-300 text-base group"
                      >
                        <span class="text-xl group-hover:scale-110 transition-transform duration-300">üè†</span>
                        <span>Project Hub</span>
                        <span class="ml-auto opacity-60 group-hover:opacity-100 transition-opacity">‚Üí</span>
                      </a>
                    </div>
                    
                    {/* Navigation Title */}
                    <div class="mb-4">
                      <h3 class="text-sm font-semibold text-muted-foreground uppercase tracking-wider mb-3 px-3">
                        Navigation
                      </h3>
                    </div>
                    
                    {/* Main Navigation */}
                    <nav class="space-y-2">
                      <SideNavMenu items={menu} level={0} />
                    </nav>
                  </div>
                )
              }
            </ScrollArea>
          </div>
        </div>
        <div
          class=`w-full ${hide_toc && hide_sidenav && max_width ? "" : "md:w-2/3 lg:w-1/2"}`
        >
          <MainContent
            title={title}
            author={author}
            pubDatetime={pubDatetime}
            modDatetime={modDatetime}
            description={description}
            draft={draft}
            tags={tags}
            hide_breadcrumbs={hide_breadcrumbs}
            headings={headings}
          >
            <slot />
          </MainContent>
        </div>
        <div
          class=`py-6 hidden lg:flex max-h-static_sidemenu sticky top-[69px] ${hide_toc && hide_sidenav && max_width ? "" : "px-4 lg:w-1/4"}`
        >
          <ScrollArea className="h-full w-full" client:only="react">
            {
              !docconfig.hide_table_of_contents && !hide_toc && (
                <div class="pl-2">
                  <TableofContent {headings} />
                </div>
              )
            }
          </ScrollArea>
        </div>
      </main>
      <Footer class="border-t border-border bg-background" />
    </div>
  </body>
</html>
